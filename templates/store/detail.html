{% extends 'base.html' %}

{% block content %}
    <div id="section">

    <div class="detail_top_box">
        <div class="detail_top">
            <button id="back" onclick="history.back()">
                <i class="fas fa-chevron-left fa-2x"></i>
            </button>
            <b id="store_name"></b>
        </div>
    </div>

    <div class="store">
        <div class="swiper mySwiper">
            <div id="image_slide" class="swiper-wrapper">

            </div>
            <div class="swiper-pagination"></div>
        </div>
    </div>

    <div id="store_info" class="detail"></div>

    <div class="result">
        <b id="detail_review">전체 리뷰 결과</b>
        <div class="detail_star">
            <div class="star-ratings">

                <div class="star-ratings-fill space-x-2 text-lg" :style="{ width: ratingToPercent + '%' }">
                    <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span>
                </div>
                <div class="star-ratings-base space-x-2 text-lg">
                    <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span>
                </div>
            </div>
        </div>
        <button id="write" type="button"><i class="fas fa-pen"> 리뷰 작성하기</i></button>
    </div>

    <div class="review">
        <button id="review_btn"><b>리 뷰</b></button>
    </div>

    <div id="review_list" class="review_detail">
        <<<<<<< HEAD
        <div class='review_box' style="display:flex; flex-direction : row">
            <div style="display: flex;flex-direction : column ; align-items: center; width:120px;">
                <img style="margin-top: 5px" id='profile_review' src='/static/images/profile.png'>
                <div>{{ user.nickname }}</div>
                <div style=" border-radius:18px; border: 1px solid white; background-color: #dddddd; padding:5px">
                    <img id='taste_img' src='/static/images/spicy.png' alt='매워'>
                    <img id='taste_img' src='/static/images/salt.png' alt='짜'>
                    <img id='taste_img' src='/static/images/sweet.png' alt='달아'>
                    <img id='taste_img' src='/static/images/amount.png' alt='양'>
                </div>
            </div>
            <div style="flex-direction : column; ">
                <div style="display:flex;justify-content: space-between; flex-direction: row; padding-left: 8px; padding-right: 8px; padding-top: 5px">
                    <div>

                    </div>
                    <div></div>
                    <div>
                        <img id='review_img' src='/static/images/review_amount.png' alt='양'>
                        <img id='review_img' src='/static/images/kindness.png' alt='친철도'>
                        <img id='review_img' src='/static/images/hygiene.png' alt='위생'>
                        <img id='review_img' src='/static/images/price.png' alt='가격'>
                    </div>
                </div>
                <div style="border: solid 1px #BDBDBD; height: 83px; width: 219px; border-radius: 6px; margin-top: 7px">
                    리뷰 텍스트 들어갈 곳
                </div>
            </div>
        </div>

    </div>

    <script>
        var swiper = new Swiper(".mySwiper", {
            pagination: {
                el: ".swiper-pagination",
            },
        });

        $(function () {
            $('#heart').click(function () {
                location.href = "{% url 'like:api' %}"
            });
        });

        $('#write').click(function () {
            location.href = "{% url 'review:create' pk=pk %}";
        });


        $(document).ready(function () {
            $.ajax({
                url: "{% url 'store:detail_api' pk=pk %}",
                headers: {
                    "Authorization": "Token {{ token }}",
                },
                method: "GET",
                datatype: 'json',
                success: function (data) {
                    var info_html = ""
                    info_html += "<p><b>" + data.store_name + "</p></b>"
                    info_html += "<ul>"
                    info_html += "<li><p>" + data.store_adress + "</p></li>"
                    info_html += "<li><p>" + data.store_tel + "</p></li>"
                    info_html += "</ul>"
                    document.getElementById("store_info").innerHTML = info_html
                    $('#store_name').text(data.store_name);

                },
                error: function (request, status, error) {
                    console.log('error');
                    console.log(error);
                },
                complete: function (data) {
                    console.log('끝');
                }
            });

            $.ajax({
                url: "{% url 'store:image_api' pk=pk %}",
                headers: {
                    "Authorization": "Token {{ token }}",
                },
                method: "GET",
                datatype: 'json',
                success: function (data) {
                    var image_html = "";
                    console.log(data);
                    for (var i = 0; i < data.length; i++) {
                        image_html += "<div id='sw' class='swiper-slide'>"
                        image_html += "<img class='detail_image' src='" + data[i].image_tag + "'>"
                        image_html += "</div>"
                    }

                    document.getElementById("image_slide").innerHTML = image_html

                },
                error: function (request, status, error) {
                    console.log('error');
                    console.log(error);
                },
                complete: function (data) {
                    console.log('끝');
                }
            });

            $.ajax({
                url: "{% url 'review:list_api' pk=pk %}",
                headers: {
                    "Authorization": "Token{{ token }}",
                },
                method: "GET",
                datatype: 'json',
                success: function (review) {
                    var review_desc = ""
                    for (var i = 0; i < review.length; i++) {
                        review_desc += "<div class='review_box' style='display:flex; flex-direction : row;'>"
                        review_desc += "<div style='display: flex;flex-direction : column ; align-items: center; width:120px;'>"
                        review_desc += "<img style='margin-top: 5px' id='profile_review' src='/static/images/profile.png'>"
                        review_desc += "<div>{{ user.nickname }}</div>"
                        review_desc += "<div style='border-radius:18px; border: 1px solid white; background-color: #dddddd; padding:5px'>"
                        review_desc += "<img id='taste_img' src='/static/images/spicy.png' alt='매워'>"
                        review_desc += "<img id='taste_img' src='/static/images/salt.png' alt='짜'>"
                        review_desc += "<img id='taste_img' src='/static/images/sweet.png' alt='달아'>"
                        review_desc += "<img id='taste_img' src='/static/images/amount.png' alt='양'>"
                        review_desc += "</div></div>"
                            < div
                        style = "flex-direction : column; " >
                            < div
                        style = "display:flex;justify-content: space-between; flex-direction: row; padding-right: 8px; padding-top: 5px" >
                            < div >
                            < div

                        class

                        = "star-ratings" >

                            < div

                        class

                        = "star-ratings-fill space-x-2 text-lg"
                    :
                        style = "{ width: ratingToPercent + '%' }" >
                            < span >★</span>
                        <span>★</span>
                        <span>★</span>
                        <span>★</span>
                        <span>★</span>
                    </div>
                        <div class="star-ratings-base space-x-2 text-lg">
                            <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span> 5.0
                        </div>

                    </div>
                    </div>
                        <div></div>
                        <div>
                            <img id='review_img' src='/static/images/review_amount.png' alt='양'>
                                <img id='review_img' src='/static/images/kindness.png' alt='친철도'>
                                    <img id='review_img' src='/static/images/hygiene.png' alt='위생'>
                                        <img id='review_img' src='/static/images/price.png' alt='가격'>
                        </div>
                    </div>
                        <div
                            style="border: solid 1px #BDBDBD; height: 83px; width: 219px; border-radius: 6px; margin-top: 7px">
                            리뷰 텍스트 들어갈 곳
                        </div>
                    </div>
                    </div>
                    }
                    document.getElementById("review_list").innerHTML = review_desc

                    },
                    error: function (request, status, error)
                        {
                            alert("error");
                            console.log('error');
                            console.log(error);
                        }
                    ,
                    complete: function (data)
                        {
                            console.log('끝');
                        }
                    });
                    });
    </script>
{% endblock %}
